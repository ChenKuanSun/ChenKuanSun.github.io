{"title":"Unity ML-Agents 第二章：範本介紹","date":"2019-01-31T18:46:25.000Z","date_formatted":{"ll":"Feb 1, 2019","L":"02/01/2019","MM-DD":"02-01"},"thumbnail":"https://cdn-images-1.medium.com/max/5760/1*lyyj3__WZn6unCBMksGIJQ.png","link":"2019/02/01/Unity_ML_02","comments":true,"tags":["Machine Learning","Reinforcement Learning","Unity ML"],"categories":["Unity ML"],"updated":"2020-04-13T23:55:01.632Z","content":"<p>經過上一章的安裝，這次直接帶大家進入UnityML的世界，在本章我們會來開啟 Unity ML-Agents Toolkit中的經典範例-3D小球來介紹使用預訓練好的模型套用在範例專案上。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*lyyj3__WZn6unCBMksGIJQ.png\" style=\"max-width: 100%;\"><h2 id=\"專案環境設定\">專案環境設定<a href=\"#專案環境設定\" title=\"專案環境設定\"></a></h2><p>這邊環境就用最新版的2018.3.3f1，安裝完成後打開Project，（點Open）</p>\n<img src=\"https://cdn-images-1.medium.com/max/4320/1*UjQWMiABknKrqAbxwIYOnw.png\" style=\"max-width: 100%;\"><p>進到ml-agents/，點UnitySDK直接按打開就可以了。（截圖是OSX ,基本上往後步驟兩個作業系統操作幾乎一樣）</p>\n<img src=\"https://cdn-images-1.medium.com/max/2688/1*MbxHB5mE-23FpT7tlH0O9w.png\" style=\"max-width: 100%;\"><p>這邊他會問版本問題，不用理他直接按open，後面會問要不要升版本也是按升級。(windows版按continue，會有一些包的問題也都是直接按continue)</p>\n<img src=\"https://cdn-images-1.medium.com/max/4004/1*M0d3GCt9KZvfAYAMPWwX8w.png\" style=\"max-width: 100%;\"><p>進來之後會看到這個畫面，如果是Uniy老手可以跳過下一段，這邊開始講解怎麼調整工作區到方便處理的位置。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*AnzalLpYKxgeVOAg-Tavvg.png\" style=\"max-width: 100%;\"><p>(選用)首先點上面的Windows&gt;Layouts&gt;2 by 3，就會看到跟我一樣的排列工作區</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*f51hpjfzchbsWyzAn4ZSIQ.png\" style=\"max-width: 100%;\"><p>(選用)然後關掉一個分區，接下來直接按著TAB直接拉到左邊(可視個人喜好調整)，</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*hy2cjTG03bOIaXryV2ObbQ.png\" style=\"max-width: 100%;\"><p>(選用)最後會長這樣。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*nVFb9Pex-8xcYF1n62kadQ.png\" style=\"max-width: 100%;\"><p>接下來安裝上一章節說的 <a href=\"https://s3.amazonaws.com/unity-ml-agents/0.5/TFSharpPlugin.unitypackage\" target=\"_blank\">TensorFlowSharp</a>，到下載好的目錄。點選兩下匯入</p>\n<img src=\"https://cdn-images-1.medium.com/max/3114/1*gZ9asYjn4zqI_KGy7X4R9w.png\" style=\"max-width: 100%;\"><p>點完之後會回專案然後載入會出現匯入的視窗，按import</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*OUSgPaeoolE_n4NyDv_kSg.png\" style=\"max-width: 100%;\"><p>匯入完之後檢查最左邊的工作區，點ML-agents&gt;Plugins，看有沒有出現Computer資料夾，有的話代表匯入成功。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*PXw2bPhjyrAMal45DtqQ_A.png\" style=\"max-width: 100%;\"><p>接下來點Edit&gt;Project Settings…，打開專案設定。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*kVZRckyYZs1qt4k7oEG3qQ.png\" style=\"max-width: 100%;\"><p>點開左邊的Player然後點選other Settings的選項會跑出一堆選項。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*xwE6y_YN2SyFC2PqCqJE5g.png\" style=\"max-width: 100%;\"><p>拉到下面找到 Scripting Define Symbols的選項，在空格裡輸入</p>\n<pre><code>ENABLE_TENSORFLOW</code></pre><img src=\"https://cdn-images-1.medium.com/max/5760/1*PnANw8ioKM3aiVt30A_sBw.png\" style=\"max-width: 100%;\"><img src=\"https://cdn-images-1.medium.com/max/2000/1*-0irclFFV7b9GybUBj9Xrg.png\" style=\"max-width: 100%;\"><p>輸入完會自動儲存，記得勾選unsafe Code，因為有載入TFSharp的外掛，所以沒有勾的話會出Error，點右上角的紅色按鈕離開，接下來環境就設定完成了(Windows用戶要多一個步驟，要點File&gt;Save Project)，可以進入最基礎的3D小球範例。</p>\n<h2 id=\"3d-ball\">3D Ball<a href=\"#3d-ball\" title=\"3D Ball\"></a></h2><p>接下來開啟3D Ball場景，打開左邊的目錄</p>\n<pre><code>Assets/ML-Agents/Examples/3DBall/Scenes</code></pre><p>底下點兩下3DBall，就會出現如我下面的場景。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*zLrlsa4Q_i7pCBJPu38JAw.png\" style=\"max-width: 100%;\"><h3 id=\"載入預訓練好的模型\">載入預訓練好的模型<a href=\"#載入預訓練好的模型\" title=\"載入預訓練好的模型\"></a></h3><p>打開左邊的目錄，到Prefabs下面點兩下Game，</p>\n<pre><code>Assets/ML-Agents/Examples/3DBall/Prefabs</code></pre><img src=\"https://cdn-images-1.medium.com/max/5760/1*2ggjY3vrP12WSp9HG5jr6A.png\" style=\"max-width: 100%;\"><p>右邊的工作區點Platform，然後屬性視窗會有一堆屬性，找到Brain屬性，點一下框框</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*ZJ_DQBHqdwGSTDi4J4gwhA.png\" style=\"max-width: 100%;\"><p>會發現目錄視窗跳出黃框，</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*-yGigzLeGlQ8HW-I60_L2w.png\" style=\"max-width: 100%;\"><p>把左邊黃框那個資料夾裡的 3DBallLearning直接拉到剛剛點的那個框框內。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*oxNixPsHyVhXvxz3hkjbnw.png\" style=\"max-width: 100%;\"><p>之後點一下左邊目錄內的 3DBallLearning，會出現屬性。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*0RrmgVMQd-apLuoYCXj4Qw.png\" style=\"max-width: 100%;\"><p>把TFMODEL資料夾裡已經訓練好的模型 3DBallLearning拉到屬性內的Model，這樣子你已經完成載入預訓練好的數據了，點選中間上面的撥放鍵就可以看到已經訓練好的板板穩穩地接住小球了。</p>\n<img src=\"https://cdn-images-1.medium.com/max/5760/1*TyvD7s3MByL70MCeviLV7w.png\" style=\"max-width: 100%;\"><p>這邊概略講解一下原理，因為這12組可以視為一組小球+板板，我們剛剛在Prefabs裡可以發現一個關卡就是由一個平台含一個平面+一顆小球組成，而在這個平台裡我們有套用一組Agents腳本，然後在控制平台的Brain裡塞入一個Reinforcement Learning模型，採用<a href=\"https://medium.com/@jonathan_hui/rl-proximal-policy-optimization-ppo-explained-77f014ec3f12\" target=\"_blank\">Proximal Policy Optimization (PPO)</a>演算法，有興趣的可以點入連結研究算法。</p>\n<p>模型在訓練的時候會一直調整參數，完成之後會存成一組.bytes檔，打開的話會看到一堆不是人讀的編碼，不過要注意的是，每次訓練的參數在TF不一樣版本下載入會有相容性的問題，建議在訓練完之後用打開命令列匯出一組環境檔來做為備份。(前提是有裝anaconda or miniconda)</p>\n<pre><code>conda env export &gt; environment.yml</code></pre><p>輸入這個指令會得到一個environment.yml檔案，以後有需要用到同樣環境的時候只要在檔案存在的目錄下打</p>\n<pre><code>conda env create -f ./environment.yml</code></pre><p>就會創建出一模一樣的環境了。</p>\n<p>基本上分成12組訓練是因為訓練的時候都是用同一組模型在訓練，可以分12路平行訓練，如果覺得電腦夠強的話，可以增加到50組，也可以加速運算，建議是採多路運算，然後速度保持在可以觀察的情況下，這樣才可以隨時調整，不然訓練了一天一夜之後發現弄錯了就還得重來。</p>\n<p>前面兩個章節都是引導大家建立好完整的環境來使用這些套件，下個章節開始會教大家用這些範本來訓練自己的模型。</p>\n<p>如果本篇文章有幫到你的忙，<br>選單的<a href=\"https://www.paypal.me/ChenKuanSun\" target=\"_blank\">Donate</a>可以請我喝一杯英式紅茶拿鐵，<br>讓我有更多的咖啡因(X)</p>\n<p>下一章：</p>\n<h2 id=\"unity-ml-agents-第三章：訓練範本\"><a href=\"./Unity-ML/3\">Unity ML-Agents 第三章：訓練範本</a><a href=\"#unity-ml-agents-第三章：訓練範本\" title=\"Unity ML-Agents 第三章：訓練範本\"></a></h2>","prev":{"title":"Unity ML-Agents 第三章：訓練範本","link":"2019/02/03/Unity_ML_03"},"next":{"title":"Unity ML-Agents 第一章：建構環境","link":"2019/01/31/Unity_ML_01"},"plink":"https://chenkuansun.github.io/2019/02/01/Unity_ML_02/","toc":[{"id":"專案環境設定","title":"專案環境設定","index":"1"},{"id":"3d-ball","title":"3D Ball","index":"2","children":[{"id":"載入預訓練好的模型","title":"載入預訓練好的模型","index":"2.1"}]},{"id":"unity-ml-agents-第三章：訓練範本","title":"Unity ML-Agents 第三章：訓練範本","index":"3"}]}